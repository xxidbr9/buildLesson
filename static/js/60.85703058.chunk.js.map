{"version":3,"sources":["queries/liveclass/index.js","pages/BookingList/index.jsx"],"names":["CREATE","gql","BookingList","userDetails","JSON","parse","localStorage","getItem","useState","current","pageSize","pagination","set_pagination","useQuery","ALL","skip","pvid","client","variables","role","name","toLowerCase","data","refetch","loading","useMutation","onError","err","console","log","createSession","loadingCreate","columns","title","dataIndex","render","text","moment","format","key","record","status","classUrl","type","href","target","onClick","a","liveClassName","subjectInfo","subject","level","startTime","endTime","bookingId","Number","description","location","className","gutter","dataSource","getBookings","onChange","filters","sorter","extra","centered","style","margin","textAlign"],"mappings":"i3BAEO,IAAMA,EAASC,YAAH,KCQJ,SAASC,IACvB,IAAMC,EAAcC,KAAKC,MAAMC,aAAaC,QAAQ,iBAAmB,GADlC,EAEAC,mBAAS,CAC7CC,QAAS,EACTC,SAAU,KAJ0B,mBAE9BC,EAF8B,KAElBC,EAFkB,OAOFC,YAASC,IAAK,CAChDC,MAAOZ,EAAYa,KACnBC,OAAQA,IAAM,cACdC,UAAW,CAAEC,KAAMhB,EAAYa,KAAOb,EAAYgB,KAAKC,KAAKC,cAAgB,MAHrEC,EAP6B,EAO7BA,KAAMC,EAPuB,EAOvBA,QAASC,EAPc,EAOdA,QAPc,EAaeC,YAAYzB,EAAQ,CACvEiB,OAAQA,IAAM,gBAGdS,QAAS,SAACC,GACTC,QAAQC,IAAIF,MAlBuB,mBAa9BG,EAb8B,KAaJC,EAbI,KAabP,QASlBQ,EAAU,CACf,CACCC,MAAO,aACPC,UAAW,QAEZ,CACCD,MAAO,UACPC,UAAW,uBAEZ,CACCD,MAAO,aACPC,UAAW,YACXC,OAAQ,SAACC,GAAD,gBAAaC,IAAOD,GAAME,OAAO,gCAE1C,CACCL,MAAO,WACPC,UAAW,UACXC,OAAQ,SAACC,GAAD,gBAAaC,IAAOD,GAAME,OAAO,gCAE1C,CACCL,MAAO,SACPC,UAAW,UAEZ,CACCD,MAAO,SACPM,IAAK,SACLJ,OAAQ,SAACC,EAAMI,GAAP,MACW,SAAlBA,EAAOC,OACND,EAAOE,SACN,kBAAC,IAAD,CAAQC,KAAK,UAAUC,KAAMJ,EAAOE,SAAUG,OAAO,SACpD,kBAAC,QAAD,oBAE4B,UAA1B1C,EAAYgB,KAAKC,KACpB,kBAAC,IAAD,CACCuB,KAAK,UACLnB,QAASO,EACTe,QAAO,sBAAE,sBAAAC,EAAA,sEACFjB,EAAc,CACnBZ,UAAW,CACV8B,cAAc,SAAD,OAAWR,EAAOS,YAAYC,QAA9B,YAAyCV,EAAOS,YAAYE,OACzEC,UAAWZ,EAAOY,UAClBC,QAASb,EAAOa,QAChBC,UAAWC,OAAOf,EAAOxB,MACzBwC,YAAY,SAAD,OAAWhB,EAAOS,YAAYC,QAA9B,YAAyCV,EAAOS,YAAYE,MAA5D,yBAAkFX,EAAOiB,aAP9F,uBAUFlC,IAVE,4CAaT,kBAAC,QAAD,sBAGD,IAGD,OASJ,OAAKpB,EAAYa,KAehB,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAS0C,UAAU,QAClB,uBAAKC,OAAQ,IACZ,2BACC,uBACCnC,QAASA,EACTQ,QAASA,EACT4B,WAAYtC,EAAOA,EAAKuC,YAAc,GACtCC,SA3BW,SAACnD,EAAYoD,EAASC,EAAQC,GAC9CrD,EAAeD,IA2BVA,WAAYA,QAtBhB,kBAAC,IAAD,KACC,kBAAC,IAAD,CAASuD,UAAQ,GAChB,2BACC,2BACC,uBAAYC,MAAO,CAAEC,OAAQ,WAAYC,UAAW,WAApD","file":"static/js/60.85703058.chunk.js","sourcesContent":["import { gql } from \"apollo-boost\"\n\nexport const CREATE = gql`\n\tmutation CREATE_SESSION($liveClassName: String!, $startTime: Date!, $endTime: Date!, $description: String!, $bookingId: Int!) {\n\t\tcreateSession(\n\t\t\tliveClassName: $liveClassName\n\t\t\tstartTime: $startTime\n\t\t\tendTime: $endTime\n\t\t\tdescription: $description\n\t\t\tbookingId: $bookingId\n\t\t) {\n\t\t\tmeetingId\n\t\t\tmeetingName\n\t\t\tjoinAsModerator\n\t\t\tjoinAsStudent\n\t\t\tmoderatorPassword\n\t\t\tattendeePassword\n\t\t\tduration\n\t\t}\n\t}\n`\n","import React, { useState, useEffect, useCallback } from \"react\"\nimport { useMutation, useQuery } from \"react-apollo\"\nimport moment from \"moment\"\nimport { Trans } from \"@lingui/macro\"\nimport { Row, Col, Table, Typography } from \"antd\"\nimport { Button, Section, Layout } from \"components\"\nimport { client } from \"helpers\"\nimport { ALL } from \"queries/booking\"\nimport { CREATE } from \"queries/liveclass\"\n\nexport default function BookingList() {\n\tconst userDetails = JSON.parse(localStorage.getItem(\"userDetails\")) || {}\n\tconst [pagination, set_pagination] = useState({\n\t\tcurrent: 1,\n\t\tpageSize: 10\n\t})\n\n\tconst { data, refetch, loading } = useQuery(ALL, {\n\t\tskip: !userDetails.pvid,\n\t\tclient: client[\"bookingClient\"],\n\t\tvariables: { role: userDetails.pvid ? userDetails.role.name.toLowerCase() : \"\" }\n\t})\n\n\tconst [createSession, { loading: loadingCreate }] = useMutation(CREATE, {\n\t\tclient: client[\"liveclassClient\"],\n\t\t// onCompleted: () => refetch(),\n\t\t// onCompleted: () => window.location.reload(),\n\t\tonError: (err) => {\n\t\t\tconsole.log(err)\n\t\t}\n\t})\n\n\tconst columns = [\n\t\t{\n\t\t\ttitle: \"Booking ID\",\n\t\t\tdataIndex: \"pvid\"\n\t\t},\n\t\t{\n\t\t\ttitle: \"Subject\",\n\t\t\tdataIndex: \"subjectInfo.subject\"\n\t\t},\n\t\t{\n\t\t\ttitle: \"Start Time\",\n\t\t\tdataIndex: \"startTime\",\n\t\t\trender: (text) => `${moment(text).format(\"dddd, DD MMM YYYY hh:mm A\")}`\n\t\t},\n\t\t{\n\t\t\ttitle: \"End Time\",\n\t\t\tdataIndex: \"endTime\",\n\t\t\trender: (text) => `${moment(text).format(\"dddd, DD MMM YYYY hh:mm A\")}`\n\t\t},\n\t\t{\n\t\t\ttitle: \"Status\",\n\t\t\tdataIndex: \"status\"\n\t\t},\n\t\t{\n\t\t\ttitle: \"Action\",\n\t\t\tkey: \"action\",\n\t\t\trender: (text, record) =>\n\t\t\t\trecord.status === \"paid\" ? (\n\t\t\t\t\trecord.classUrl ? (\n\t\t\t\t\t\t<Button type=\"primary\" href={record.classUrl} target=\"blank\">\n\t\t\t\t\t\t\t<Trans>Open Class</Trans>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) : userDetails.role.name === \"Tutor\" ? (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\t\tloading={loadingCreate}\n\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\tawait createSession({\n\t\t\t\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\t\t\t\tliveClassName: `Class ${record.subjectInfo.subject} ${record.subjectInfo.level}`,\n\t\t\t\t\t\t\t\t\t\tstartTime: record.startTime,\n\t\t\t\t\t\t\t\t\t\tendTime: record.endTime,\n\t\t\t\t\t\t\t\t\t\tbookingId: Number(record.pvid),\n\t\t\t\t\t\t\t\t\t\tdescription: `Class ${record.subjectInfo.subject} ${record.subjectInfo.level}, location at ${record.location}`\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tawait refetch()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Trans>Create Class</Trans>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t\"-\"\n\t\t\t\t\t)\n\t\t\t\t) : (\n\t\t\t\t\t\"-\"\n\t\t\t\t)\n\t\t}\n\t]\n\n\tconst onChange = (pagination, filters, sorter, extra) => {\n\t\tset_pagination(pagination)\n\t}\n\n\tif (!userDetails.pvid) {\n\t\treturn (\n\t\t\t<Layout>\n\t\t\t\t<Section centered>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<Typography style={{ margin: \"4em auto\", textAlign: \"center\" }}>You Must Login To Access This Page</Typography>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</Section>\n\t\t\t</Layout>\n\t\t)\n\t}\n\n\treturn (\n\t\t<Layout>\n\t\t\t<Section className=\"p2em\">\n\t\t\t\t<Row gutter={32}>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<Table\n\t\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t\t\tcolumns={columns}\n\t\t\t\t\t\t\tdataSource={data ? data.getBookings : []}\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\tpagination={pagination}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</Section>\n\t\t</Layout>\n\t)\n}\n"],"sourceRoot":""}