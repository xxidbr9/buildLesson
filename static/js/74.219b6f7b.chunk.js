(this.webpackJsonpcudysg=this.webpackJsonpcudysg||[]).push([[74],{1695:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return x}));a(1431);var n=a(1456),c=(a(91),a(37)),r=(a(97),a(25)),o=(a(121),a(35)),i=a(65),d=a.n(i),l=a(19),s=a(113),u=a(28),m=a(0),f=a.n(m),b=a(38),p=a.n(b),g=a(55),I=a(42),h=a(173),S=a.n(h),j=a(163),E=a(16);function x(){S.a.defaults.baseURL="https://payment.stage.cudy.co/api/v1",S.a.defaults.headers.common["api-key"]="63d0abee-eeaa-4d23-88fe-1b0f245a1643";var e=JSON.parse(localStorage.getItem("userDetails"))||{},t="sg"===e.country?"SGD":"id"===e.country?"IDR":"",a=Object(m.useState)([]),i=Object(u.a)(a,2),b=i[0],h=i[1],x=Object(m.useState)({current:1,pageSize:10}),O=Object(u.a)(x,2),v=O[0],k=O[1],y=Object(m.useState)(!0),D=Object(u.a)(y,2),A=D[0],Y=D[1],M=Object(m.useState)(!1),T=Object(u.a)(M,2),w=T[0],C=T[1],N=[{title:"Payment ID",dataIndex:"id"},{title:"Description",dataIndex:"description"},{title:"Amount",dataIndex:"amount",sorter:function(e,t){return e.amount-t.amount},sortDirections:["descend","ascend"],render:function(e){return"".concat(t," ").concat(Object(E.e)(e))},width:150},{title:"Booking ID",dataIndex:"booking_id",width:150},{title:"Created At",dataIndex:"createdAt",render:function(e){return"".concat(p()(e).format("dddd, DD MMM YYYY hh:mm A"))}},{title:"Status",dataIndex:"status_payment.name"}],U=[{title:"Transaction ID",dataIndex:"id"},{title:"".concat(e.pvid&&"Student"===e.role.name?"Tutor's":"Student's"," name"),dataIndex:"".concat(e.pvid&&"Student"===e.role.name?"toUser.firstName":"fromUser.firstName")},{title:"Class information",dataIndex:"booking.subjectInfo.pvid",render:function(e,t){return"".concat(t.booking.subjectInfo.subject," ").concat(t.booking.subjectInfo.level)}},{title:"Class time",dataIndex:"booking.startTime",render:function(e){return"".concat(p()(e).format("dddd, DD MMM YYYY hh:mm A"))}},{title:"Amount",dataIndex:"booking.price",render:function(e){return"".concat(t," ").concat(Object(E.e)(e))},width:150},{title:"Booking ID",dataIndex:"booking.pvid",width:150},{title:"Created At",dataIndex:"createdAt",render:function(e){return"".concat(p()(e).format("dddd, DD MMM YYYY hh:mm A"))}},{title:"Status",dataIndex:"status"}],R=Object(g.c)(j.b,{variables:{role:e.pvid?e.role.name.toLowerCase():""},onError:function(e){console.log("GET_USER_TRANSACTIONS",e)}}),_=R.data,z=(R.refetch,R.loading);Object(m.useEffect)((function(){w||(e.email?J():(console.log("not auth"),Y(!1)),C(!0))}),[w,e.email,J]);var J=Object(m.useCallback)(Object(s.a)(d.a.mark((function t(){var a,n,c,r=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.length>0&&void 0!==r[0]?r[0]:v,Y(!0),t.prev=2,t.next=5,S.a.post("/payments/list/transaction",{email:e.email,applicationName:"cudy-i3",limit:a.pageSize,offset:(a.current-1)*a.pageSize});case 5:n=t.sent,c=n.data.data,h(c.list.map((function(e){return Object(l.a)({key:e.id},e)}))),k(Object(l.a)({},v,{total:c.total})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.log("fetch error",t.t0);case 14:Y(!1);case 15:case"end":return t.stop()}}),t,null,[[2,11]])}))));return e.pvid?f.a.createElement(I.n,null,f.a.createElement(I.u,{className:"p2em"},f.a.createElement(c.a,{gutter:32},f.a.createElement(r.a,null,f.a.createElement(o.a,null,"Transaction History"),f.a.createElement(n.a,{loading:z,columns:U,dataSource:_?_.getUserTransactions:[]}))),"Student"===e.role.name&&f.a.createElement(c.a,{gutter:32},f.a.createElement(r.a,null,f.a.createElement(o.a,null,"Payment History"),f.a.createElement(n.a,{loading:A,columns:N,dataSource:b,onChange:function(e,t,a,n){k(e),J(e)},pagination:v}))))):f.a.createElement(I.n,null,f.a.createElement(I.u,{centered:!0},f.a.createElement(c.a,null,f.a.createElement(r.a,null,f.a.createElement(o.a,{style:{margin:"4em auto",textAlign:"center"}},"You Must Login To Access This Page")))))}}}]);
//# sourceMappingURL=74.219b6f7b.chunk.js.map