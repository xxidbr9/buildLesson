{"version":3,"sources":["pages/Tutor/Profile/IntroVideos.jsx"],"names":["Drag","styled","div","HorizontalRow","attrs","type","gutter","media","mobile","StyledModal","Modal","footer","closable","centered","UploadModal","Upload","StyledButton","Button","EmptyMessage","p","withI18n","data","fetchUser","unauthorizedUser","loading","handlers","i18n","useState","selectedItem","setSelectedItem","modal","setModal","isPlaying","setPlaying","uploadModal","setUploadModal","file","imagePreview","localFile","setLocalFile","setProfileCompletionModal","useMutation","mutateUploadIntroVideo","client","newClient","onCompleted","onError","err","renderError","uploadVideo","loadingUpload","mutateDeleteResource","deleteVideo","loadingDelete","handleSelectItem","path","handleDeleteVideo","item","variables","relativePath","paddingHorizontal","noPadding","style","overflowX","visible","onCancel","content","level","src","width","height","class","marginBottom","controls","beforeUpload","reader","FileReader","onloadend","prev","result","readAsDataURL","handleUploadToLocal","multiple","listType","accept","showUploadList","showPreviewIcon","onRemove","subheader","icon","disabled","onClick","then","success","_","size","muted","playing","loop","SERVER_BASE_URL","length","paddingTop","paddingBottom","description","className","lg","align","map","key","id","xs","onSelectItem","onDeleteVideo","isUnauthorized","block"],"mappings":"g8CAaA,IAAMA,EAAOC,IAAOC,IAAV,KAWJC,EAAgBF,YAAO,KAAKG,OAAM,iBAAO,CAC9CC,KAAM,OAENC,OAAQ,MAHaL,CAAH,IAgBhBM,IAAMC,OAhBU,MAuBbC,EAAcR,YAAOS,KAAON,OAAM,iBAAO,CAC9CO,QAAQ,EACRC,UAAU,EACVC,UAAU,KAHSZ,CAAH,KAcXa,EAAcb,YAAOc,KAAQX,OAAM,iBAAO,CAC/CS,UAAU,EACVF,QAAQ,KAFWV,CAAH,KASXe,EAAef,YAAOgB,IAAPhB,CAAH,KAQZiB,EAAejB,IAAOkB,EAAV,KA6MHC,gCAvMf,YAA2F,IAAD,IAAnEC,YAAmE,MAA5D,GAA4D,EAAxDC,EAAwD,EAAxDA,UAAWC,EAA6C,EAA7CA,iBAAkBC,EAA2B,EAA3BA,QAASC,EAAkB,EAAlBA,SAAUC,EAAQ,EAARA,KAAQ,EACjDC,mBAAS,IADwC,mBAClFC,EADkF,KACpEC,EADoE,OAE/DF,oBAAS,GAFsD,mBAElFG,EAFkF,KAE3EC,EAF2E,OAGzDJ,oBAAS,GAHgD,mBAGlFK,EAHkF,KAGvEC,EAHuE,OAInDN,oBAAS,GAJ0C,mBAIlFO,EAJkF,KAIrEC,EAJqE,OAKvDR,mBAAS,CAAES,KAAM,GAAIC,aAAc,KALoB,mBAKlFC,EALkF,KAKvEC,EALuE,KAMjFC,EAA8Bf,EAA9Be,0BANiF,EAQvCC,YAAYC,IAAwB,CACrFC,OAAQC,YAAU,YAClBC,YAAa,kBAAMvB,KACnBwB,QAAS,SAACC,GAAD,OAASC,YAAYD,MAX0D,mBAQlFE,EARkF,KAQ1DC,EAR0D,KAQnE1B,QARmE,EAcvCiB,YAAYU,IAAsB,CACnFR,OAAQC,YAAU,YAClBC,YAAa,kBAAMvB,KACnBwB,QAAS,SAACC,GAAD,OAASC,YAAYD,MAjB0D,oBAclFK,GAdkF,MAc1DC,GAd0D,MAcnE7B,QAMhB8B,GAAmB,SAACC,GACzB1B,EAAgB0B,GAChBxB,GAAS,GACTE,GAAW,IAkCNuB,GAAoB,SAACC,GAAD,OAAUL,GAAY,CAAEM,UAAW,CAAEC,aAAcF,EAAKF,SAiFlF,OAAI/B,GAAW6B,GAAsB,kBAAC,IAAD,MAGpC,kBAAC,IAAD,CAASO,kBAAmB,EAAGC,UAAWrD,IAAQsD,MAAO,CAAEC,WAAYvD,KAAU,WAChF,kBAAC,IAAD,CAAOwD,QAAS9B,EAAavB,QAAQ,EAAOsD,SA1Ff,WAC9B9B,GAAe,GACfI,EAAa,MAyFX,kBAAC,IAAD,CAAS2B,QAAS,kBAAC,QAAD,uCAA+CC,MAAO,IACvEjB,GACA,kBAAC,IAAD,CAASrC,UAAQ,GAChB,kBAAC,IAAD,CAAWuD,IAAI,4DAA4DC,MAAO,IAAKC,OAAQ,IAAKC,MAAM,YAG1GrB,GACD,yBAAKY,MAAO,CAAEU,aAAc,QAC1BlC,EAAUD,aACV,2BAAOoC,UAAQ,EAACJ,MAAM,QACrB,4BAAQD,IAAK9B,EAAUD,cAAgB,MAGxC,kBAACvB,EAAD,CACC4D,aA9GoB,SAACtC,GAE3B,OAlB2B,SAACA,GAC5B,IAAMuC,EAAS,IAAIC,WACnBD,EAAOE,UAAY,WAClBtC,GAAa,SAACuC,GAAD,sBAAgBA,EAAhB,CAAsB1C,OAAMC,aAAcsC,EAAOI,aAE/DJ,EAAOK,cAAc5C,GAYrB6C,CAAoB7C,IACb,GA6GD8C,UAAU,EACVC,SAAS,UACTC,OAAO,UACPC,eAAgB,CAAEC,iBAAiB,GACnCC,SAAU,kBAAMhD,GAAa,SAACuC,GAAD,sBAAgBA,EAAhB,CAAsB1C,KAAM,UAEzD,kBAACpC,EAAD,KACC,2BACC,uBAAMK,KAAK,WAEZ,kBAAC,IAAD,CACC6D,QAAS,kBAAC,QAAD,4DACTsB,UAAW,kBAAC,QAAD,8DACXrB,MAAO,OAOb,kBAACnD,EAAD,CAAcX,KAAK,UAAUoF,KAAK,SAASC,UAAWpD,EAAUF,KAAMuD,QA3I/C,WACzBpD,EAAa,CAAEF,aAAc,KAC7BY,EAAY,CAAES,UAAW,CAAEtB,KAAME,EAAUF,QAAUwD,MAAK,WACzDzD,GAAe,GACf,IAAQ0D,QAAQnE,EAAKoE,EAAE,wDAuI4EtE,QAAS0B,GAA3G,QACSA,EAAgB,kBAAC,QAAD,uBAAgC,kBAAC,QAAD,+BACzC,IAtCjB,OAuCQ,IACNZ,EAAUF,MACV,kBAAC,IAAD,CAAY2D,KAAK,QAAQN,KAAK,QAAQE,QAAS,kBAAMpD,GAAa,SAACuC,GAAD,sBAAgBA,EAAhB,CAAsBzC,aAAc,UAAtG,QACQ,kBAAC,QAAD,uBAIV,kBAAC5B,EAAD,CAAauD,QAASlC,GAASF,EAAcqC,SAlKtB,WACxBlC,GAAS,GACTE,GAAW,KAiKT,2BAAOwC,UAAQ,EAACuB,OAAK,EAACC,QAASjE,EAAWqC,MAAM,OAAO6B,MAAM,GAC5D,4BAAQ9B,IAAK+B,IAAkBvE,EAAa2B,SAlI3B,IAAhBlC,EAAK+E,OACJ7E,EAEF,kBAAC,IAAD,CAASV,UAAQ,EAACwD,MAAO7D,IAAS,OAAS,MAAOsD,MAAO,CAAEuC,WAAY,EAAGC,cAAe,IACxF,kBAAC,IAAD,CACCC,YACC,kBAACrF,EAAD,KACC,kBAAC,QAAD,iHAEC,0BAAMsF,UAAU,UAAUb,QAAS,kBAAMnD,GAA0B,aAWzE,uBAAKiE,GAAI,IACR,uBAAKpG,KAAK,OAAOqG,MAAM,SAASpG,OAAQ,IACvC,uBAAKmG,GAAI,EAAGD,UAAU,yBACrB,kBAAC,IAAD,CACCpC,IAAI,yDACJC,MAAO7D,IAAS,OAAS,IACzB8D,OAAQ9D,IAAS,OAAS,OAG5B,uBAAKiG,GAAI,IACR,kBAAC,IAAD,CACCvC,QAAS,kBAAC,QAAD,kCACTsB,UACC,kBAAC,QAAD,wHAKDrB,MAAO,EACPK,aAAa,QAEd,kBAAC,IAAD,CAAQnE,KAAK,UAAUoF,KAAK,SAASE,QAAS,kBAAMxD,GAAe,KAAnE,QACQ,kBAAC,QAAD,kCASZ,oCACC,kBAAChC,EAAD,KACEkB,EAAKsF,KAAI,SAAClD,GAAD,OACT,uBAAKmD,IAAKnD,EAAKoD,GAAIC,GAAI,GAAIL,GAAI,GAC9B,kBAAC,IAAD,iBACKhD,EADL,CAECsD,aAAczD,GACd0D,cAAexD,GACfzB,SAAUA,EACVkF,eAAgB1F,WAKlBA,GACD,2BACC,uBAAKkF,GAAI,GACR,kBAAC,IAAD,CAAQpG,KAAK,SAASoF,KAAK,SAASE,QAAS,kBAAMxD,GAAe,IAAO+E,OAAK,GAA9E,QACQ,kBAAC,QAAD","file":"static/js/76.ca22109a.chunk.js","sourcesContent":["import React, { useState } from \"react\"\nimport styled from \"styled-components\"\n// prettier-ignore\nimport { Section, VideoCard, Modal, Heading, Button, Upload, ButtonLink, Empty, Loading, GifPlayer } from \"components\"\nimport { Col, Row, Icon, message } from \"antd\"\n// import ReactPlayer from \"react-player\"\nimport { useMutation } from \"react-apollo\"\nimport { mutateUploadIntroVideo, mutateDeleteResource } from \"queries/profile\"\nimport { newClient, mobile, renderError, media } from \"helpers\"\nimport { Trans, t } from \"@lingui/macro\"\nimport { withI18n } from \"@lingui/react\"\nimport { SERVER_BASE_URL } from \"helpers/constants\"\n\nconst Drag = styled.div`\n\ttext-align: center;\n\tdisplay: block;\n\tpadding: 2em;\n\tbackground: #f3f3f3;\n\tborder-radius: 8px;\n\t> p {\n\t\tfont-size: 4em;\n\t}\n`\n\nconst HorizontalRow = styled(Row).attrs(() => ({\n\ttype: \"flex\",\n\t// align: \"middle\",\n\tgutter: 16\n}))`\n\theight: 250px;\n\tmargin-bottom: 1.5em;\n\tpadding-top: 1em;\n\tflex-wrap: nowrap;\n\toverflow-x: scroll;\n\twidth: auto;\n\t-webkit-overflow-scrolling: touch;\n\t&::-webkit-scrollbar {\n\t\tdisplay: none;\n\t}\n\n\t${media.mobile`\n\t\t&& {\n\t\t\tflex-wrap: nowrap;\n\t\t}\n\t`}\n`\n\nconst StyledModal = styled(Modal).attrs(() => ({\n\tfooter: false,\n\tclosable: false,\n\tcentered: true\n}))`\n\t.ant-modal-body {\n\t\tpadding: 0;\n\t}\n\t.ant-modal-content {\n\t\tbackground: transparent;\n\t\tbox-shadow: none;\n\t}\n`\n\nconst UploadModal = styled(Upload).attrs(() => ({\n\tcentered: true,\n\tfooter: false\n}))`\n\t.ant-upload.ant-upload-select {\n\t\tdisplay: block;\n\t}\n`\n\nconst StyledButton = styled(Button)`\n\t&&& {\n\t\tspan {\n\t\t\tcolor: rgba(0, 0, 0, 0.25);\n\t\t}\n\t}\n`\n\nconst EmptyMessage = styled.p`\n\tspan.primary {\n\t\tcursor: pointer;\n\t}\n`\n\nfunction IntroVideos({ data = [], fetchUser, unauthorizedUser, loading, handlers, i18n }) {\n\tconst [selectedItem, setSelectedItem] = useState({})\n\tconst [modal, setModal] = useState(false)\n\tconst [isPlaying, setPlaying] = useState(false)\n\tconst [uploadModal, setUploadModal] = useState(false)\n\tconst [localFile, setLocalFile] = useState({ file: \"\", imagePreview: \"\" })\n\tconst { setProfileCompletionModal } = handlers\n\n\tconst [uploadVideo, { loading: loadingUpload }] = useMutation(mutateUploadIntroVideo, {\n\t\tclient: newClient(\"resource\"),\n\t\tonCompleted: () => fetchUser(),\n\t\tonError: (err) => renderError(err)\n\t})\n\n\tconst [deleteVideo, { loading: loadingDelete }] = useMutation(mutateDeleteResource, {\n\t\tclient: newClient(\"resource\"),\n\t\tonCompleted: () => fetchUser(),\n\t\tonError: (err) => renderError(err)\n\t})\n\n\tconst handleSelectItem = (path) => {\n\t\tsetSelectedItem(path)\n\t\tsetModal(true)\n\t\tsetPlaying(true)\n\t}\n\n\tconst handleCloseModal = () => {\n\t\tsetModal(false)\n\t\tsetPlaying(false)\n\t}\n\n\tconst handleUploadToLocal = (file) => {\n\t\tconst reader = new FileReader()\n\t\treader.onloadend = () => {\n\t\t\tsetLocalFile((prev) => ({ ...prev, file, imagePreview: reader.result }))\n\t\t}\n\t\treader.readAsDataURL(file)\n\t}\n\n\tconst handleUploadVideo = () => {\n\t\tsetLocalFile({ imagePreview: \"\" })\n\t\tuploadVideo({ variables: { file: localFile.file } }).then(() => {\n\t\t\tsetUploadModal(false)\n\t\t\tmessage.success(i18n._(t`Your video has been successfully uploaded!`))\n\t\t})\n\t}\n\n\tconst handleBeforeUpload = (file) => {\n\t\thandleUploadToLocal(file)\n\t\treturn false\n\t}\n\n\tconst handleCloseUploadModal = () => {\n\t\tsetUploadModal(false)\n\t\tsetLocalFile({})\n\t}\n\n\tconst handleDeleteVideo = (item) => deleteVideo({ variables: { relativePath: item.path } })\n\n\tconst renderVideos = () => {\n\t\tif (data.length === 0) {\n\t\t\tif (unauthorizedUser) {\n\t\t\t\treturn (\n\t\t\t\t\t<Section centered width={mobile ? \"100%\" : \"60%\"} style={{ paddingTop: 0, paddingBottom: 0 }}>\n\t\t\t\t\t\t<Empty\n\t\t\t\t\t\t\tdescription={\n\t\t\t\t\t\t\t\t<EmptyMessage>\n\t\t\t\t\t\t\t\t\t<Trans>\n\t\t\t\t\t\t\t\t\t\tThis tutor didn't upload any introduction videos yet. Ask them to{\" \"}\n\t\t\t\t\t\t\t\t\t\t<span className=\"primary\" onClick={() => setProfileCompletionModal(true)}>\n\t\t\t\t\t\t\t\t\t\t\tcomplete this section\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t\t\t</EmptyMessage>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Section>\n\t\t\t\t)\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<Col lg={24}>\n\t\t\t\t\t<Row type=\"flex\" align=\"middle\" gutter={32}>\n\t\t\t\t\t\t<Col lg={8} className=\"ta-center mb0__mobile\">\n\t\t\t\t\t\t\t<GifPlayer\n\t\t\t\t\t\t\t\tsrc=\"https://assets10.lottiefiles.com/temp/lf20_zZuL4A.json\"\n\t\t\t\t\t\t\t\twidth={mobile ? \"100%\" : 200}\n\t\t\t\t\t\t\t\theight={mobile ? \"100%\" : 200}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col lg={16}>\n\t\t\t\t\t\t\t<Heading\n\t\t\t\t\t\t\t\tcontent={<Trans>Upload your introductions</Trans>}\n\t\t\t\t\t\t\t\tsubheader={\n\t\t\t\t\t\t\t\t\t<Trans>\n\t\t\t\t\t\t\t\t\t\tBy uploading your introduction videos, there will be a higher chance for you to attract other\n\t\t\t\t\t\t\t\t\t\tstudents/parents.\n\t\t\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlevel={4}\n\t\t\t\t\t\t\t\tmarginBottom=\"2em\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Button type=\"primary\" icon=\"upload\" onClick={() => setUploadModal(true)}>\n\t\t\t\t\t\t\t\t&nbsp; <Trans>Upload your video now</Trans>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</Col>\n\t\t\t)\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<HorizontalRow>\n\t\t\t\t\t{data.map((item) => (\n\t\t\t\t\t\t<Col key={item.id} xs={16} lg={6}>\n\t\t\t\t\t\t\t<VideoCard\n\t\t\t\t\t\t\t\t{...item}\n\t\t\t\t\t\t\t\tonSelectItem={handleSelectItem}\n\t\t\t\t\t\t\t\tonDeleteVideo={handleDeleteVideo}\n\t\t\t\t\t\t\t\tsetModal={setModal}\n\t\t\t\t\t\t\t\tisUnauthorized={unauthorizedUser}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t))}\n\t\t\t\t</HorizontalRow>\n\t\t\t\t{!unauthorizedUser && (\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col lg={8}>\n\t\t\t\t\t\t\t<Button type=\"dashed\" icon=\"upload\" onClick={() => setUploadModal(true)} block>\n\t\t\t\t\t\t\t\t&nbsp; <Trans>Upload another video</Trans>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\t\t\t</>\n\t\t)\n\t}\n\n\tif (loading || loadingDelete) return <Loading />\n\n\treturn (\n\t\t<Section paddingHorizontal={0} noPadding={mobile} style={{ overflowX: !mobile && \"hidden\" }}>\n\t\t\t<Modal visible={uploadModal} footer={false} onCancel={handleCloseUploadModal}>\n\t\t\t\t<Heading content={<Trans>Upload your introduction video</Trans>} level={4} />\n\t\t\t\t{loadingUpload && (\n\t\t\t\t\t<Section centered>\n\t\t\t\t\t\t<GifPlayer src=\"https://assets3.lottiefiles.com/packages/lf20_dBbqyA.json\" width={250} height={250} class=\"mb2em\" />\n\t\t\t\t\t</Section>\n\t\t\t\t)}\n\t\t\t\t{!loadingUpload && (\n\t\t\t\t\t<div style={{ marginBottom: \"2em\" }}>\n\t\t\t\t\t\t{localFile.imagePreview ? (\n\t\t\t\t\t\t\t<video controls width=\"100%\">\n\t\t\t\t\t\t\t\t<source src={localFile.imagePreview || \"\"} />\n\t\t\t\t\t\t\t</video>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<UploadModal\n\t\t\t\t\t\t\t\tbeforeUpload={handleBeforeUpload}\n\t\t\t\t\t\t\t\tmultiple={false}\n\t\t\t\t\t\t\t\tlistType=\"picture\"\n\t\t\t\t\t\t\t\taccept=\"video/*\"\n\t\t\t\t\t\t\t\tshowUploadList={{ showPreviewIcon: true }}\n\t\t\t\t\t\t\t\tonRemove={() => setLocalFile((prev) => ({ ...prev, file: \"\" }))}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Drag>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t<Icon type=\"inbox\" />\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<Heading\n\t\t\t\t\t\t\t\t\t\tcontent={<Trans>Click here or drag and drop your video to this area</Trans>}\n\t\t\t\t\t\t\t\t\t\tsubheader={<Trans>Supported formats: .flv, .mp4, .3gp, .avi, .mov, .wmv</Trans>}\n\t\t\t\t\t\t\t\t\t\tlevel={4}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Drag>\n\t\t\t\t\t\t\t</UploadModal>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<StyledButton type=\"primary\" icon=\"upload\" disabled={!localFile.file} onClick={handleUploadVideo} loading={loadingUpload}>\n\t\t\t\t\t&nbsp; {loadingUpload ? <Trans>Please wait...</Trans> : <Trans>Upload this video now</Trans>}\n\t\t\t\t</StyledButton>{\" \"}\n\t\t\t\t&nbsp;{\" \"}\n\t\t\t\t{localFile.file && (\n\t\t\t\t\t<ButtonLink size=\"large\" icon=\"close\" onClick={() => setLocalFile((prev) => ({ ...prev, imagePreview: \"\" }))}>\n\t\t\t\t\t\t&nbsp; <Trans>Change video</Trans>\n\t\t\t\t\t</ButtonLink>\n\t\t\t\t)}\n\t\t\t</Modal>\n\t\t\t<StyledModal visible={modal && selectedItem} onCancel={handleCloseModal}>\n\t\t\t\t<video controls muted playing={isPlaying} width=\"100%\" loop={false}>\n\t\t\t\t\t<source src={SERVER_BASE_URL + selectedItem.path} />\n\t\t\t\t</video>\n\t\t\t</StyledModal>\n\n\t\t\t{renderVideos()}\n\t\t</Section>\n\t)\n}\n\nexport default withI18n()(IntroVideos)\n"],"sourceRoot":""}